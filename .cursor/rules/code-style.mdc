---
Rule Type: Context
Context: code-style
---

# Code Style and Formatting Rules

## PEP 8 Compliance
- Follow [PEP 8](https://www.python.org/dev/peps/pep-0008/) style guide
- Use a linter (e.g., `pylint`, `flake8`, or `black`) to check compliance

## Naming Conventions

### Classes: PascalCase
```python
class RecommendationEngine:
    pass

class DataProcessor:
    pass

class APIService:
    pass
```

### Functions and Methods: snake_case
```python
def find_similar_teams(team: str, month: int) -> list:
    pass

def calculate_accuracy(predictions: list, actual: list) -> float:
    pass

def get_recommendations(team: str, month: int) -> list:
    pass
```

### Constants: UPPER_SNAKE_CASE
```python
DEFAULT_TOP_N = 5
MAX_SIMILARITY_THRESHOLD = 0.9
MIN_SIMILARITY_THRESHOLD = 0.75
```

### Variables: snake_case
```python
team_name = "Avengers"
current_month = 200105
similarity_score = 0.85
recommendation_list = []
```

### Private Methods/Attributes: Prefix with single underscore
```python
def _calculate_internal_metric(self):
    pass

def _build_similarity_matrix(self, month: int):
    pass

self._cache = {}
self._transition_matrix = {}
```

## Line Length
- **Soft limit**: 100 characters
- **Hard limit**: 120 characters (only when necessary)
- Break long lines using parentheses for continuation

```python
# Good: Break long lines
result = (
    similarity_score * similarity_weight +
    sequence_score * (1 - similarity_weight)
)

# Good: Function parameters on multiple lines
def recommend(
    self,
    target_team: str,
    current_month: int,
    top_n: int = 2,
    k_similar: int = 19
) -> List[Tuple[str, float, float]]:
    pass
```

## Indentation
- Use **4 spaces** for indentation (never tabs)
- Use consistent indentation for multi-line function calls
- Align continuation lines properly

```python
# Good: Consistent indentation
if condition:
    result = some_function(
        param1,
        param2,
        param3
    )

# Good: Aligned parameters
def long_function_name(
        first_param: str,
        second_param: int,
        third_param: float
) -> bool:
    pass
```

## Whitespace

### Blank Lines
Use blank lines to separate:
- Top-level function and class definitions (2 lines)
- Methods within a class (1 line)
- Logical sections within functions
- Import groups (1 line between groups)

```python
# Standard library
import os

# Third-party
import numpy as np

# Local imports
from src.ml import RecommendationEngine


class MyClass:
    """Class description."""
    
    def method_one(self):
        pass
    
    def method_two(self):
        pass
```

### No Trailing Whitespace
- Remove all trailing whitespace
- End files with a newline character

### Spacing Around Operators
- Use spaces around operators: `x = y + z`
- No spaces around `=` in keyword arguments: `func(param=value)`

```python
# Good
result = x + y * z
func(param=value, other=123)

# Bad
result=x+y*z
func( param = value )
```

## Import Organization

### Order
1. Standard library imports
2. Third-party imports
3. Local application imports (from `src.*`)

### Formatting
- Sort imports alphabetically within each group
- Use `from` imports when importing specific items
- Group related imports together

```python
# Standard library - alphabetical
import os
import sys
from typing import Dict, List, Optional, Tuple

# Third-party - alphabetical
import numpy as np
import pandas as pd
from sklearn.metrics.pairwise import cosine_similarity

# Local - alphabetical
from src.data import DataProcessor
from src.ml import RecommendationEngine, SimilarityEngine
```

## Code Formatting Examples

### Function Definitions
```python
# Good: Clear parameter formatting
def process_data(
    team_name: str,
    month: int,
    normalize: bool = True
) -> Dict[str, float]:
    """Process team data for given month."""
    pass

# Good: Simple function on one line
def get_team_count() -> int:
    """Return total number of teams."""
    return len(self.teams)
```

### List/Dict Comprehensions
```python
# Good: Simple comprehensions
scores = [team.score for team in teams if team.active]

# Good: Multi-line for complex comprehensions
recommendations = [
    (practice, score, level)
    for practice, score, level in raw_recommendations
    if score > threshold
]
```

### Conditionals
```python
# Good: Clear conditional structure
if condition:
    do_something()
elif other_condition:
    do_other()
else:
    do_default()

# Good: Early returns for clarity
def process(data):
    if not data:
        return None
    if not validate(data):
        raise ValueError("Invalid data")
    return process_valid_data(data)
```

## Consistency with Existing Codebase

When writing code, match the style of existing files:
- Check `src/ml/recommender.py` for ML component patterns
- Check `src/data/loader.py` for data processing patterns
- Check `src/api/service.py` for API service patterns
- Follow the same formatting and naming conventions
